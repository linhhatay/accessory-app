

extends ../base

mixin product(name, imageCover, price, discount, rating, quantity, slug)
    div(class="max-w-[20%] slide transition-transform duration-[0.4s] relative flex-[1_0_20%] p-[10px] md:flex-[1_0_calc(100%_/_3)] sm:flex-[1_0_calc(100%_/_2)]")
        div(class="inline-block absolute left-[15px] top-[20px]")
            span(class="block min-w-[36px] h-[36px] leading-[36px] text-center text-white text-[0.9em] rounded-[50%] bg-orange-500")= `-${discount}%`
        a(class="cursor-pointer")
            img(class="w-full object-cover before:content-[''] before:block before:pb-[100%]" src=`/img/products/${imageCover}` alt='')
        div(class="text-[1.15em] px-0 py-[0.8em]")
            a(class="mt-[0.3em] mb-[1em] text-[0.9em] leading-[1.3] h-[2.5em] overflow-ellipsis line-clamp-2 cursor-pointer" href=`${slug}`)
            = name
            div(class="text-[1.4rem]")
            .product-box__rating
                i.fa-solid.fa-star
                i.fa-solid.fa-star
                i.fa-solid.fa-star
                i.fa-solid.fa-star
                i.fa-solid.fa-star
            div(class="text-[1.2em] leading-none")
                -const priceRound = Math.round(price / 1000) * 1000;
                span(class="opacity-60 text-[15px] font-normal text-[#666] line-through mr-[0.3em]")= priceRound.toLocaleString('vi-VN', { minimumFractionDigits: 0, maximumFractionDigits: 3 })
                span.current-symbol &#x20AB;
                -const priceDiscount = Math.round((price - (price * discount / 100)) / 1000) * 1000
                span(class="text-[#d0011b] text-[16px]")= priceDiscount.toLocaleString('vi-VN', { minimumFractionDigits: 0, maximumFractionDigits: 3 })
                span.current-symbol &#x20AB;
            div(class="text-[#009627] text-[0.9em] mt-[0.5em]")
                i(class="fa-solid fa-check mr-[3px]")
                | Còn hàng



block content 
    .container
        div(class="min-h-[60px] max-w-[1170px] pt-[20px] pb-[10px] px-[15px]")
            div
                h1(class="heading-primary product-name")= product.name
                include ../components/breadCrumbs
        div(class="h-px max-w-[calc(100%_-_30px)] m-auto bg-gray-300")

        div
            div(class="grid grid-cols-[5fr_4fr_3fr] pt-[20px]")
                div(class="px-[15px] py-0 overflow-hidden")
                    img(class="w-full mb-[15px]" src=`/img/products/${product.imageCover}`) 
                    div(class="max-w-[1140px] w-full h-[104.375px]")
                        each thumb in product.images
                            div(class="inline-block p-[10px] max-w-[25%] w-full")
                                a(class="block")
                                    img(src=`/img/products/${thumb}`)
                .call-to-action
                    .product-rating
                        div 
                            i.fa-solid.fa-star
                            i.fa-solid.fa-star
                            i.fa-solid.fa-star
                            i.fa-solid.fa-star
                            i.fa-solid.fa-star
                        span.reviews-counter (40 đánh giá)
                    .product-price
                        p 
                            -const priceRound = Math.round(product.price / 1000) * 1000;
                            span= priceRound.toLocaleString('vi-VN', { style: 'currency', currency: 'VND' })
                            -const priceDiscount = Math.round((product.price - (product.price * product.discount / 100)) / 1000) * 1000
                            span(class="product-current-price")= priceDiscount.toLocaleString('vi-VN', { minimumFractionDigits: 0, maximumFractionDigits: 3 })
                    .vat 
                        span Có VAT 
                        span Bảo hành 24 Tháng
                    form(method="POST" action=`/${product._id}/add-to-cart`) 
                        .quantity
                            .btn.btn--minus
                                svg(focusable='false', style='width: 10px; height: 10px;', viewBox='0 0 10 2', role='presentation')
                                    path(d='M10 0v2H0V0z', fill='currentColor')
                            input(class="quantity-select" type='number', value='1' name="quantity")
                            .btn.btn--plus
                                svg(focusable='false', style='width: 10px; height: 10px;', viewBox='0 0 10 10', role='presentation')
                                    path(d='M6 4h4v2H6v4H4V6H0V4h4V0h2v4z', fill='currentColor', fill-rule='evenodd')
                        .cta-button
                            button.product-add-to-cart(type="submit") Thêm vào giỏ hàng
                            a.product-buy-now Mua Ngay
                div(class="pl-[10px] pt-0 pb-[30px] px-[15px]")
                    aside(class="mb-[20px]")
                        include ../components/services

    div(class="container px-[15px] py-0")
        div(class="flex")
            div 
                div(class="max-w-[1170px] flex flex-wrap")
                    div(class="relative border-t-neutral-200 mt-[10px] mb-[20px] pt-[20px] pb-0 px-0 border-t border-solid")
                        div
                            h2(class="text-[1.5em] leading-[1.3] font-normal mb-[0.5em]") Bài viết giới thiệu sản phẩm
                            -const desc = product.description.split('\\n')
                            each line in desc
                                //- p(class="mb-[1em]")= line
                                -const check = line.length < 80
                                if check
                                    h3(class="text-[14px] mb-[0.5em]")= line
                                else
                                    p(class="mb-[1em]")= line

            div(class="w-[30%] ml-[20px] mr-0 mt-[9px] mb-0")
                div(class="border p-[15px] border-solid border-[#333]")
                    h2(class="border-b-neutral-200 text-[1.5em] leading-[1.3] font-normal mb-[0.5em] pb-2.5 border-b border-solid") Thông số kỹ thuật
                    div 
                        ul(class="list-none") 
                            each spec in product.specs
                                li(class="mb-[8px]")= spec.type
                                li(class="mb-[8px]")= spec.driver
                                li(class="mb-[8px]")= spec.effects
                                li(class="mb-[8px]")= spec.connection
                                li(class="mb-[8px]")= spec.earCups
                                li(class="mb-[8px]")= spec.headband
                                li(class="mb-[8px]")= spec.frequencyRange
                                li(class="mb-[8px]")= spec.cable
                                li(class="mb-[8px]")= spec.weight
        div(class="border-t-neutral-200 border-t border-solid pb-[10px]")
            h3(class="pt-[30px] mb-[20px] text-[1.25em]") Sản phẩm liên quan
            div(class="max-w-[1140px] flex")
                +product(product.name, product.imageCover, product.price, product.discount, product.rating, product.quantity, product.slug)
                +product(product.name, product.imageCover, product.price, product.discount, product.rating, product.quantity, product.slug)
                +product(product.name, product.imageCover, product.price, product.discount, product.rating, product.quantity, product.slug)
                +product(product.name, product.imageCover, product.price, product.discount, product.rating, product.quantity, product.slug)
                +product(product.name, product.imageCover, product.price, product.discount, product.rating, product.quantity, product.slug)
                
			



